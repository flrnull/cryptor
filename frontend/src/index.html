<div id="app">
  <h1>Cryptor</h1>
  <input type="file" id="fileInput" />
  <textarea id="fileContent" rows="20" cols="80"></textarea>
  <div>
    <input type="password" id="password" placeholder="Enter password" />
    <button id="decryptBtn">Decrypt</button>
    <button id="saveBtn">Save</button>
  </div>
</div>

<script>
  const fileInput = document.getElementById("fileInput");
  const fileContent = document.getElementById("fileContent");
  const password = document.getElementById("password");
  const decryptBtn = document.getElementById("decryptBtn");
  const saveBtn = document.getElementById("saveBtn");

  fileInput.addEventListener("change", async (event) => {
    const file = event.target.files[0];
    if (file) {
      const filePath = file.path;
      const result = await window.backend.App.OpenFile(filePath);
      if (result === "Encrypted") {
        alert("This file is encrypted. Please enter the password to decrypt.");
        fileContent.value = "";
      } else {
        fileContent.value = result;
      }
    }
  });

  decryptBtn.addEventListener("click", async () => {
    const content = await window.backend.App.Decrypt(password.value);
    fileContent.value = content;
  });

  saveBtn.addEventListener("click", async () => {
    await window.backend.App.SaveFile(fileContent.value, password.value);
    alert("File saved!");
  });
</script>
